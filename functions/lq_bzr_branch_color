# Set a color depending on the branch state:
# - green if the repository is up to date
# - red if there is changes to commit
# - TODO: yellow if there is some commits not pushed
#
# Add the number of pending commits and the impacted lines.

[[ "$LQ_ENABLE_BZR" != 1 ]] && return
local output
output=$(bzr version-info --check-clean --custom --template='{branch_nick} {revno} {clean}' 2> /dev/null)
[[ $? -ne 0 ]] && return
local tuple=($output)
local branch=${tuple[0]}
local revno=${tuple[1]}
local clean=${tuple[2]}

if [[ -n "$branch" ]] ; then
	if [[ "$clean" -eq 0 ]] ; then
		ret="${LQ_COLOR_CHANGES}${branch}${LQ_RESET}(${LQ_COLOR_COMMITS}$revno${LQ_RESET})"
	else
		ret="${LQ_COLOR_UP}${branch}${LQ_RESET}(${LQ_COLOR_COMMITS}$revno${LQ_RESET})"
	fi

fi
echo -ne "$ret"
